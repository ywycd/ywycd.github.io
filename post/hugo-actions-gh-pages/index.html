<!doctype html><html lang=en><head><meta charset=utf-8><meta name=referrer content="same-origin"><title>hugo通过Github Action部署到Github Pages :: ywy — 有约不来过夜半，闲敲棋子落灯花</title><meta name=viewport content="width=device-width,initial-scale=1,maximum-scale=1"><meta name=description content="通过Action部署到Github Pages。查了一些资料，有点不知道下一步。terminal修改后考虑部署到github，之前用even主"><meta name=keywords content><meta name=robots content="noodp"><link rel=canonical href=https://ywycd.github.io/post/hugo-actions-gh-pages/><link rel=stylesheet href=https://ywycd.github.io/assets/style.min.css?d41d8cd98f00b204e9800998ecf8427e><link rel=apple-touch-icon-precomposed sizes=180x180 href=https://ywycd.github.io/img/apple-icon-precomposed.png><link rel="shortcut icon" href=https://ywycd.github.io/img/apple-touch-icon-rm.png><meta name=twitter:card content="summary"><meta name=twitter:creator content><meta property="og:locale" content="en"><meta property="og:type" content="article"><meta property="og:title" content="hugo通过Github Action部署到Github Pages :: ywy"><meta property="og:description" content="通过Action部署到Github Pages。查了一些资料，有点不知道下一步。terminal修改后考虑部署到github，之前用even主"><meta property="og:url" content="https://ywycd.github.io/post/hugo-actions-gh-pages/"><meta property="og:site_name" content="ywy"><meta property="og:image" content="https://ywycd.github.io/img/apple-touch-icon-rm.png"><meta property="og:image:width" content="2048"><meta property="og:image:height" content="1024"><meta property="article:published_time" content="2020-12-19 21:16:07 +0800 +0800"></head><body><div class="container center headings--one-size"><header class=header style=background-image:url(/img/banner-rain-731313_1920.png);background-position:50%;background-repeat:no-repeat;background-size:cover><div class=header__inner><div class=header__logo><a href=https://ywycd.github.io/><div class=logo>ASDW</div></a></div><div class=menu-trigger>menu</div></div><nav class=menu><ul class="menu__inner menu__inner--desktop"><li><a href=/about>About</a></li><li><a href=/archive>Archive</a></li><li><a href=/tagcloud>TagCloud</a></li></ul><ul class="menu__inner menu__inner--mobile"><li><a href=/about>About</a></li><li><a href=/archive>Archive</a></li><li><a href=/tagcloud>TagCloud</a></li></ul></nav><div class=feed-links></div></header><div class=content><div class=post><h1 class=post-title>hugo通过Github Action部署到Github Pages</h1><div class=post-meta><span class=post-date>2020-12-19</span>
<span class=post-author>::
ywy</span>
:: Mod 2020-12-19(0120684)</div><span class=post-tags>#<a href=https://ywycd.github.io/tags/hugo/>hugo</a>&nbsp;
#<a href=https://ywycd.github.io/tags/github/>github</a>&nbsp;</span><div class=post-toc id=post-toc><h2 class=post-toc-title></h2><div class="post-toc-content always-active"><nav id=TableOfContents><ul><li><a href=#上传xxgithubio>上传xx.github.io</a></li><li><a href=#部署action>部署action</a></li><li><a href=#访问问题>访问问题</a></li></ul></nav></div></div><div class=post-content><div><p>通过Action部署到Github Pages。查了一些资料，有点不知道下一步。terminal修改后考虑部署到github，之前用even主题到netlify。<br>本地win有hugo文档，部署到git仓库，查阅有建私人仓库、其他repositories。简单点username.github.io建两个branch。</p><h2 id=上传xxgithubio>上传xx.github.io<a href=#上传xxgithubio class=hanchor arialabel=Anchor>&#8983;</a></h2><p>添加远程，分支提示无法建立，切换分支、加ssh不行。加ssh key提示已使用，不是正确的密钥。看
<a href=https://github.com/peaceiris/actions-gh-pages>gh-pages</a> 有提。</p><div class=highlight><pre class=chroma><code class=language-shell data-lang=shell>ssh-keygen -t rsa -b <span class=m>4096</span> -C <span class=s2>&#34;</span><span class=k>$(</span>git config user.email<span class=k>)</span><span class=s2>&#34;</span> -f gh-pages -N <span class=s2>&#34;&#34;</span>
<span class=c1># You will get 2 files:</span>
<span class=c1>#   gh-pages.pub (public key)</span>
<span class=c1>#   gh-pages     (private key)</span>
</code></pre></div><p>重建key，clip &lt; ~/.ssh/xxx.pub复制到Deploy Keys。 具体步骤如下，等待上传。</p><div class=highlight><pre class=chroma><code class=language-shell data-lang=shell>git checkout -b main
git add .
git commit -m <span class=s2>&#34;first commit&#34;</span>
git push origin main
</code></pre></div><h2 id=部署action>部署action<a href=#部署action class=hanchor arialabel=Anchor>&#8983;</a></h2><p>win无法新建.github文件夹，用git bash mkdir。建立<code>.github/workflows/gh-pages.yml</code>看文档做修改。新建名为ACTIONS_DEPLOY_KEY的Secrets，内容上面生成的私钥。git push后自动生成分支。</p><div class=highlight><pre class=chroma><code class=language-yml data-lang=yml><span class=k>name</span><span class=p>:</span><span class=w> </span>github<span class=w> </span>pages<span class=w>
</span><span class=w>
</span><span class=w></span><span class=k>on</span><span class=p>:</span><span class=w>
</span><span class=w>  </span><span class=k>push</span><span class=p>:</span><span class=w>
</span><span class=w>    </span><span class=k>branches</span><span class=p>:</span><span class=w>
</span><span class=w>      </span>- main<span class=w>  
</span><span class=w>
</span><span class=w></span><span class=k>jobs</span><span class=p>:</span><span class=w>
</span><span class=w>  </span><span class=k>deploy</span><span class=p>:</span><span class=w>
</span><span class=w>    </span><span class=k>runs-on</span><span class=p>:</span><span class=w> </span>ubuntu<span class=m>-18.04</span><span class=w>
</span><span class=w>    </span><span class=k>steps</span><span class=p>:</span><span class=w>
</span><span class=w>      </span>- <span class=k>uses</span><span class=p>:</span><span class=w> </span>actions/checkout@v2<span class=w>
</span><span class=w>        </span><span class=k>with</span><span class=p>:</span><span class=w>
</span><span class=w>          </span><span class=k>submodules</span><span class=p>:</span><span class=w> </span><span class=kc>true</span><span class=w>  
</span><span class=w>          </span><span class=k>fetch-depth</span><span class=p>:</span><span class=w> </span><span class=m>0</span><span class=w>    
</span><span class=w>
</span><span class=w>      </span>- <span class=k>name</span><span class=p>:</span><span class=w> </span>Setup<span class=w> </span>Hugo<span class=w>
</span><span class=w>        </span><span class=k>uses</span><span class=p>:</span><span class=w> </span>peaceiris/actions-hugo@v2<span class=w>
</span><span class=w>        </span><span class=k>with</span><span class=p>:</span><span class=w>
</span><span class=w>          </span><span class=k>hugo-version</span><span class=p>:</span><span class=w> </span><span class=s1>&#39;0.74.3&#39;</span><span class=w>
</span><span class=w>          </span><span class=k>extended</span><span class=p>:</span><span class=w> </span><span class=kc>true</span><span class=w>
</span><span class=w>
</span><span class=w>      </span>- <span class=k>name</span><span class=p>:</span><span class=w> </span>Build<span class=w>
</span><span class=w>        </span><span class=k>run</span><span class=p>:</span><span class=w> </span>hugo<span class=w> </span>--minify<span class=w>
</span><span class=w>
</span><span class=w>      </span>- <span class=k>name</span><span class=p>:</span><span class=w> </span>Deploy<span class=w>
</span><span class=w>        </span><span class=k>uses</span><span class=p>:</span><span class=w> </span>peaceiris/actions-gh-pages@v3<span class=w>
</span><span class=w>        </span><span class=k>with</span><span class=p>:</span><span class=w>
</span><span class=w>          </span><span class=k>deploy_key</span><span class=p>:</span><span class=w> </span>${{<span class=w> </span>secrets.ACTIONS_DEPLOY_KEY<span class=w> </span>}}<span class=w>
</span><span class=w>          </span><span class=k>publish_dir</span><span class=p>:</span><span class=w> </span>./public<span class=w>
</span><span class=w>          </span><span class=k>commit_message</span><span class=p>:</span><span class=w> </span>${{<span class=w> </span>github.event.head_commit.message<span class=w> </span>}}<span class=w>
</span></code></pre></div><h2 id=访问问题>访问问题<a href=#访问问题 class=hanchor arialabel=Anchor>&#8983;</a></h2><p>推送后默认改为gh-pages。访问xx.github.io显示404，以为没加README.md。Settings里GitHub Pages Source下切换分支，可行。<br>修改terminal，灯大说的那些用上一些。折腾主题时间大于写博客，还是记录点东西吧。</p></div></div><div class=pagination><div class=pagination__title><span class=pagination__title-h>Read other posts</span><hr></div><div class=pagination__buttons><span class="button previous"><a href=https://ywycd.github.io/post/router-record/><span class=button__icon>←</span>
<span class=button__text>路由器刷机记录</span></a></span>
<span class="button next"><a href=https://ywycd.github.io/post/ndm-ssh-key/><span class=button__text>小钢炮ssh设置密钥登录（免密）</span>
<span class=button__icon>→</span></a></span></div></div></div></div><footer class=footer><div class=footer__inner><div class="copyright copyright--user"><span>:: Powered by <a href=http://gohugo.io>Hugo</a> 0.74.3</span>
<span>:: Theme made by <a href=https://twitter.com/panr>panr</a></span></div></div></footer><a id=back-to-top style=display:inline-block href=javascript:void(0); onclick="window.scrollTo({top:0,behavior:'smooth'});"><span class="iconfont icon-top"></span></a><script src=https://ywycd.github.io/assets/main.js?d41d8cd98f00b204e9800998ecf8427e></script><script>const addCopyButtons=function(clipboard){document.querySelectorAll('pre > code').forEach(function(codeBlock){const button=document.createElement('button');button.className='copy-code-button';button.type='button';button.innerText='Copy';const btnWrapper=document.createElement('div');btnWrapper.className='copy-code-button-wrap';btnWrapper.appendChild(button);button.addEventListener('click',function(){clipboard.writeText(codeBlock.innerText).then(function(){button.blur();button.innerText='Done!';setTimeout(function(){button.innerText='Copy';},2000);},function(error){button.innerText='Error';});});const pre=codeBlock.parentNode;pre.insertAdjacentElement('beforebegin',btnWrapper);});};window.addEventListener('load',function(event){const links=document.links;for(let i=0,linksLength=links.length;i<linksLength;i++){if(links[i].hostname!=window.location.hostname&&!links[i].href.startsWith('javascript:')&&!links[i].href.startsWith('mailto:')){links[i].target='_blank';}}
if(document.querySelectorAll('#TableOfContents li').length>0){document.querySelector('#post-toc').style.display='block';}
document.querySelectorAll('#post-toc a').forEach(anchor=>{anchor.addEventListener('click',evt=>{document.querySelectorAll('#post-toc a').forEach(ele=>{ele.classList.remove('active');});evt.target.classList.add('active');})});document.querySelectorAll('a[href^="#"]').forEach(anchor=>{anchor.addEventListener('click',function(e){e.preventDefault();document.getElementById(this.getAttribute('href').substring(1)).scrollIntoView({behavior:'smooth'});});});if(navigator&&navigator.clipboard){addCopyButtons(navigator.clipboard);}});</script></div></body></html>